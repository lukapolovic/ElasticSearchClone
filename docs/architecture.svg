<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="760" viewBox="0 0 1200 760" role="img" aria-label="ElasticSearchClone architecture diagram">
  <defs>
    <style>
      .title { font: 700 28px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #111827; }
      .subtitle { font: 500 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #374151; }
      .label { font: 700 16px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #111827; }
      .small { font: 500 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #374151; }
      .box { fill: #ffffff; stroke: #111827; stroke-width: 2; rx: 14; }
      .soft { fill: #f9fafb; stroke: #9ca3af; stroke-width: 2; rx: 14; }
      .accent { fill: #eef2ff; stroke: #4f46e5; stroke-width: 2; rx: 14; }
      .arrow { stroke: #111827; stroke-width: 2.5; fill: none; }
      .dashed { stroke-dasharray: 8 6; }
    </style>

    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#111827" />
    </marker>
  </defs>

  <!-- Header -->
  <text x="40" y="52" class="title">ElasticSearchClone — Architecture</text>
  <text x="40" y="80" class="subtitle">Router → Coordinators → Shard groups (replicas) with heartbeats and read quorum</text>

  <!-- Client -->
  <rect x="70" y="120" width="220" height="90" class="box"/>
  <text x="180" y="160" text-anchor="middle" class="label">Client</text>
  <text x="180" y="186" text-anchor="middle" class="small">HTTP /search</text>

  <!-- Router -->
  <rect x="410" y="120" width="300" height="90" class="accent"/>
  <text x="560" y="154" text-anchor="middle" class="label">Router</text>
  <text x="560" y="178" text-anchor="middle" class="small">Routes to ready coordinators</text>
  <text x="560" y="198" text-anchor="middle" class="small">Round-robin + retry</text>

  <!-- Coordinators group -->
  <rect x="350" y="260" width="420" height="150" class="soft"/>
  <text x="560" y="290" text-anchor="middle" class="label">Coordinators (x3)</text>
  <text x="560" y="312" text-anchor="middle" class="small">Fan-out query to shard groups</text>
  <text x="560" y="332" text-anchor="middle" class="small">Read quorum per shard group</text>
  <text x="560" y="352" text-anchor="middle" class="small">Merge + rank results</text>

  <!-- Coordinator boxes -->
  <rect x="380" y="360" width="110" height="40" class="box"/>
  <text x="435" y="386" text-anchor="middle" class="small">coord-0</text>
  <rect x="510" y="360" width="110" height="40" class="box"/>
  <text x="565" y="386" text-anchor="middle" class="small">coord-1</text>
  <rect x="640" y="360" width="110" height="40" class="box"/>
  <text x="695" y="386" text-anchor="middle" class="small">coord-2</text>

  <!-- Shard groups container -->
  <rect x="70" y="460" width="1060" height="250" class="soft"/>
  <text x="600" y="490" text-anchor="middle" class="label">Shard Groups (NUM_SHARDS = 3, REPLICAS_PER_SHARD = 3)</text>
  <text x="600" y="512" text-anchor="middle" class="small">Each group serves the same logical shard. Replicas are interchangeable.</text>

  <!-- Shard group 0 -->
  <rect x="110" y="540" width="300" height="140" class="box"/>
  <text x="260" y="568" text-anchor="middle" class="label">Shard 0</text>
  <text x="260" y="590" text-anchor="middle" class="small">replica set</text>
  <rect x="135" y="610" width="80" height="44" class="soft"/>
  <text x="175" y="637" text-anchor="middle" class="small">shard0-0</text>
  <rect x="220" y="610" width="80" height="44" class="soft"/>
  <text x="260" y="637" text-anchor="middle" class="small">shard0-1</text>
  <rect x="305" y="610" width="80" height="44" class="soft"/>
  <text x="345" y="637" text-anchor="middle" class="small">shard0-2</text>

  <!-- Shard group 1 -->
  <rect x="450" y="540" width="300" height="140" class="box"/>
  <text x="600" y="568" text-anchor="middle" class="label">Shard 1</text>
  <text x="600" y="590" text-anchor="middle" class="small">replica set</text>
  <rect x="475" y="610" width="80" height="44" class="soft"/>
  <text x="515" y="637" text-anchor="middle" class="small">shard1-0</text>
  <rect x="560" y="610" width="80" height="44" class="soft"/>
  <text x="600" y="637" text-anchor="middle" class="small">shard1-1</text>
  <rect x="645" y="610" width="80" height="44" class="soft"/>
  <text x="685" y="637" text-anchor="middle" class="small">shard1-2</text>

  <!-- Shard group 2 -->
  <rect x="790" y="540" width="300" height="140" class="box"/>
  <text x="940" y="568" text-anchor="middle" class="label">Shard 2</text>
  <text x="940" y="590" text-anchor="middle" class="small">replica set</text>
  <rect x="815" y="610" width="80" height="44" class="soft"/>
  <text x="855" y="637" text-anchor="middle" class="small">shard2-0</text>
  <rect x="900" y="610" width="80" height="44" class="soft"/>
  <text x="940" y="637" text-anchor="middle" class="small">shard2-1</text>
  <rect x="985" y="610" width="80" height="44" class="soft"/>
  <text x="1025" y="637" text-anchor="middle" class="small">shard2-2</text>

  <!-- Arrows: Client -> Router -->
  <path d="M 290 165 L 410 165" class="arrow" marker-end="url(#arrowhead)"/>

  <!-- Arrows: Router -> Coordinators group -->
  <path d="M 560 210 L 560 260" class="arrow" marker-end="url(#arrowhead)"/>

  <!-- Arrows: Coordinators -> Shard groups -->
  <path d="M 560 410 L 560 460" class="arrow" marker-end="url(#arrowhead)"/>

  <!-- Dashed arrows inside shard groups (fanout concept) -->
  <path d="M 560 430 C 450 470, 340 505, 260 540" class="arrow dashed" marker-end="url(#arrowhead)"/>
  <path d="M 560 430 C 560 470, 600 505, 600 540" class="arrow dashed" marker-end="url(#arrowhead)"/>
  <path d="M 560 430 C 670 470, 810 505, 940 540" class="arrow dashed" marker-end="url(#arrowhead)"/>

  <!-- Legend -->
  <rect x="820" y="120" width="310" height="120" class="soft"/>
  <text x="975" y="150" text-anchor="middle" class="label">Legend</text>
  <line x1="845" y1="170" x2="915" y2="170" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="930" y="175" class="small">Request flow</text>
  <line x1="845" y1="195" x2="915" y2="195" class="arrow dashed" marker-end="url(#arrowhead)"/>
  <text x="930" y="200" class="small">Fan-out concept</text>
  <rect x="845" y="212" width="26" height="18" class="accent"/>
  <text x="880" y="226" class="small">Router service</text>
</svg>